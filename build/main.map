{"version":3,"sources":["webpack:///webpack/bootstrap 76684cd34f73a38b47e1","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-router\"","webpack:///external \"koa-logger\"","webpack:///external \"@koa/cors\"","webpack:///./server/index.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/routers/index.js","webpack:///./server/controller/user.js","webpack:///external \"axios\"","webpack:///./server/config/index.js","webpack:///external \"axios-mock-adapter\"","webpack:///external \"ramda\"","webpack:///./server/middleware nonrecursive \\.js$","webpack:///./server/middleware/common.js","webpack:///external \"koa-session\"","webpack:///./nuxt.config.js"],"names":["host","process","env","HOST","port","PORT","useMiddlewares","app","context","keys","forEach","R","forEachObjIndexed","initWith","key","Server","router","use","route","routes","allowedMethods","config","require","dev","nuxt","builder","build","ctx","next","status","req","session","Promise","resolve","reject","res","on","render","promise","then","catch","listen","console","log","start","get","post","mock","onPost","base_url","reply","JSON","parse","data","mobile","userinfo","token","user","body","ret","msg","login","request","psd","_url","axios","sign","code","message","signkey","sign_key","info","id","name","sex","role_id","depart_id","deader_id","logout","addLogger","koaLogger","addCORS","cors","addBody","KoaBody","addSession","CONFIG","maxAge","overwrite","signed","rolling","module","exports","head","title","meta","charset","hid","content","link","rel","type","href","css","src","plugins","ssr","loading","NODE_ENV","cache","max","middleware","vendor","extend","isClient"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 76684cd34f73a38b47e1","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-logger\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"@koa/cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@koa/cors\"\n// module id = 4\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\nimport Router from 'koa-router'\nimport route from './routers'\nimport R from 'ramda'\n\n\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || 3000\n\n// 自动遍历 ./middleware/*.js 导出对象后再逐个遍历初始化koa中间件\nconst useMiddlewares = (app) => {\n  const context = require.context('./middleware/', false, /\\.js$/)\n  context.keys().forEach(key => {\n    R.forEachObjIndexed(\n      initWith => initWith(app)\n    )(context(key))\n  })\n}\n\nclass Server {\n  constructor() {\n    this.app = new Koa()\n    useMiddlewares(this.app)\n  }\n\n  async start(host, port) {\n    const router = new Router()\n    router.use('', route.routes())\n    this.app.use(router.routes()).use(router.allowedMethods())\n\n    // Import and Set Nuxt.js options\n    let config = require('../nuxt.config.js')\n    // 由于涉及到三个环境变化，使用在test，production 时候，为false\n    config.dev = !(app.env === 'production' || app.env === 'test')\n    // console.log('env === ', app.env, env, process.env.COOKIE_DOMAIN, process.env.APP_ENV, config.dev)\n\n    // Instantiate nuxt.js\n    const nuxt = new Nuxt(config)\n\n    // Build in development\n    if (config.dev) {\n      const builder = new Builder(nuxt)\n      await builder.build()\n    }\n\n    this.app.use(async (ctx, next) => {\n      await next()\n      ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n      ctx.req.session = ctx.session // 必须将session添加进request中，否则nuxt的req获取不到session\n      return new Promise((resolve, reject) => {\n        ctx.res.on('close', resolve)\n        ctx.res.on('finish', resolve)\n        nuxt.render(ctx.req, ctx.res, promise => {\n          // nuxt.render passes a rejected promise into callback on error.\n          promise.then(resolve).catch(reject)\n        })\n      })\n    })\n\n    this.app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n  }\n}\n\nconst app = new Server()\napp.start(host, port)\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 9\n// module chunks = 0","import Router from 'koa-router'\nimport { userinfo, login, logout } from '../controller/user'\nconst router = new Router()\n\nrouter.get('/api/user', userinfo)\nrouter.post('/api/login', login)\nrouter.post('/api/logout', logout)\nrouter.get('/api/logout', logout)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routers/index.js","import axios from 'axios'\nimport config from '../config'\nimport MockAdapter from 'axios-mock-adapter'\n\nvar mock = new MockAdapter(axios)\nmock.onPost(config.base_url + '/api/v1.user/login').reply(function (config) {\n  // console.log(JSON.parse(config.data).mobile)\n  return [\n    200,\n    {'ret': 200, 'msg': '请求成功', 'data': {'code': 0, 'message': '登录成功', 'token': 'PhU0Sd9zwUSwOQgXnJpj7pgSwdA7YD80', 'id': 1, 'mobile': '13770267077', 'name': JSON.parse(config.data).mobile, 'sex': 1, 'status': 1, 'role_id': 1, 'depart_id': 1, 'leader_id': 0}}\n  ]\n})\n\nexport const userinfo = async (ctx, next) => {\n  let token = ctx.session.user.token || ''\n  return (ctx.body = {\n    ret: 200,\n    msg: '获取成功',\n    data: { token: token }\n  })\n}\n\nexport const login = async (ctx, next) => {\n  const { mobile, psd } = ctx.request.body\n  if (!mobile || !psd) {\n    return (ctx.body = {\n      ret: 303,\n      msg: '缺少请求参数',\n      data: {}\n    })\n  }\n\n  // 发起请求\n  let _url = config.base_url + '/api/v1.user/login'\n  let req = await axios.post(_url, {\n    mobile: mobile,\n    psd: psd,\n    sign: ''\n  })\n  // 网络异常\n  if (req.status !== 200) {\n    return (ctx.body = {\n      ret: 400,\n      msg: '网络通讯异常',\n      data: {}\n    })\n  }\n  // 系统异常\n  if (req.data.ret !== 200) {\n    let ret = req.data.ret || 400\n    let msg = req.data.msg || '失败'\n    return (ctx.body = {\n      ret: ret,\n      msg: msg,\n      data: {}\n    })\n  }\n\n  // 登陆失败\n  if (req.data.data.code !== 0) {\n    let code = req.data.data.code || -1\n    let message = req.data.data.message || '登录失败'\n    return (ctx.body = {\n      ret: 200,\n      msg: '请求成功',\n      data: {\n        code: code,\n        message: message\n      }\n    })\n  }\n\n  // 登陆成功\n  let token = req.data.data.token\n  let signkey = config.sign_key\n\n  let info = {\n    id: req.data.data.id,\n    mobile: req.data.data.mobile,\n    name: req.data.data.name,\n    sex: req.data.data.sex,\n    status: req.data.data.status,\n    role_id: req.data.data.role_id,\n    depart_id: req.data.data.depart_id,\n    deader_id: req.data.data.deader_id\n  }\n\n  let session = ctx.session\n  session.user = {\n    token: token,\n    sign_key: signkey,\n    info: info\n  }\n  ctx.session = session\n\n  return (ctx.body = {\n    ret: 200,\n    msg: '请求成功',\n    data: {\n      code: 0,\n      message: '登录成功',\n      token: token,\n      info: info\n    }\n  })\n}\n\nexport const logout = async (ctx, next) => {\n  try {\n    ctx.session.user = null\n    return (ctx.body = {\n      ret: 200,\n      msg: '请求成功',\n      data: {\n        code: 0,\n        message: '退出成功'\n      }\n    })\n  } catch (e) {\n    return (ctx.body = {\n      ret: 200,\n      msg: '请求成功',\n      data: {\n        code: -1,\n        message: '退出失败'\n      }\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controller/user.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 13\n// module chunks = 0","const config = {\n  base_url: 'https://crmback.tiaoweilian.com',\n  sign_key: 'RFHIJUGVCFTRQKJMJKNHGBIOJUHGBNFG'\n}\n\nexport default config\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","module.exports = require(\"axios-mock-adapter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios-mock-adapter\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"ramda\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ramda\"\n// module id = 17\n// module chunks = 0","var map = {\n\t\"./common.js\": 19\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 18;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/middleware nonrecursive \\.js$\n// module id = 18\n// module chunks = 0","import KoaBody from 'koa-bodyparser'\nimport koaLogger from 'koa-logger'\nimport session from 'koa-session'\nimport cors from '@koa/cors'\n// import koaStatic from 'koa-static'\n\nexport const addLogger = app => {\n  app.use(koaLogger())\n}\n\n// export const addStatic = app => {\n//   // 配置静态资源加载中间件\n//   app.use(koaStatic(path.join(__dirname, './src')))\n// }\n\nexport const addCORS = app => {\n  app.use(cors())\n}\n\nexport const addBody = app => {\n  app.use(KoaBody())\n}\n\nexport const addSession = app => {\n  app.keys = ['ice']\n\n  const CONFIG = {\n    key: 'koa:sess',\n    maxAge: 86400000,\n    overwrite: true,\n    signed: true,\n    rolling: false\n  }\n  app.use(session(CONFIG, app))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/common.js","module.exports = require(\"koa-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-session\"\n// module id = 20\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'nuxt-temp',\n    meta: [\n      { charset: 'utf-8' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n      { rel: 'stylesheet', name: 'iview', href: '/styles/iview.css' },\n      { rel: 'stylesheet', name: 'theme', href: '' }\n    ]\n  },\n  css: [\n    { src: '~assets/css/main.css' },\n    'quill/dist/quill.snow.css',\n    'quill/dist/quill.bubble.css',\n    'quill/dist/quill.core.css'\n    // { src: 'iview/dist/styles/iview.css' }\n  ],\n  plugins: [\n    { src: '~plugins/flexible.js', ssr: false },\n    { src: '~plugins/iview.js', ssr: true },\n    { src: '~/plugins/quillEditor.js', ssr: false }\n  ],\n  loading: './components/loading.vue',\n  env: {\n    NODE_ENV: process.env.NODE_ENV\n  },\n  cache: {\n    max: 1000,\n    maxAge: 900000\n  },\n  router: {\n    middleware: 'route' // 在每页渲染前运行 middleware/route.js 中间件的逻辑\n  },\n  build: {\n    vendor: ['axios', 'iview', './plugins/iview.js'],\n    extend(config, ctx) {\n      if (ctx.isClient) {\n        // config.module.rules.push({\n        //   enforce: 'pre',\n        //   test: /\\.(js|vue)$/,\n        //   loader: 'eslint-loader',\n        //   exclude: /(node_modules)/\n        // })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js"],"sourceRoot":""}