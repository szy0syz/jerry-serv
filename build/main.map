{"version":3,"sources":["webpack:///webpack/bootstrap c8f0f134a7d2ddd3faa2","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"mongoose\"","webpack:///./server/lib/decorator.js","webpack:///./server/config/index.js","webpack:///./server/service/index.js","webpack:///external \"xss\"","webpack:///external \"koa-router\"","webpack:///external \"path\"","webpack:///external \"ramda\"","webpack:///external \"lodash\"","webpack:///external \"jsonwebtoken\"","webpack:///./server/routes/public/article.js","webpack:///./server/routes/public/mina.js","webpack:///./server/index.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/utils/index.js","webpack:///./server/config ^\\.\\/.*\\.json$","webpack:///./server/config/development.example.json","webpack:///./server/config/development.json","webpack:///./server/config/production.example.json","webpack:///./server/config/production.json","webpack:///./server/middleware nonrecursive \\.js$","webpack:///./server/middleware/authentication.js","webpack:///./server/middleware/authorization.js","webpack:///external \"casbin\"","webpack:///./server/middleware/common.js","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-logger\"","webpack:///external \"koa-session\"","webpack:///external \"@koa/cors\"","webpack:///external \"koa-static\"","webpack:///./server/middleware/database.js","webpack:///external \"fs\"","webpack:///./server/database/plugins/meta.js","webpack:///./server/database/schema \\.js$","webpack:///./server/database/schema/article.js","webpack:///./server/database/schema/articleTag.js","webpack:///./server/database/schema/articleType.js","webpack:///./server/database/schema/user.js","webpack:///external \"bcrypt\"","webpack:///./server/middleware/pubRouter.js","webpack:///./server/routes \\.js$","webpack:///./server/routes/admin.js","webpack:///./server/service/admin.js","webpack:///./server/service/article.js","webpack:///./server/service/articleTag.js","webpack:///./server/service/articleType.js","webpack:///./server/routes/article.js","webpack:///./server/routes/articleHandler.js","webpack:///./server/routes/articleTag.js","webpack:///./server/routes/articleType.js","webpack:///./server/wechat-lib/mina.js","webpack:///external \"request-promise\"","webpack:///external \"crypto\"","webpack:///./server/routes/qiniu.js","webpack:///./server/lib/qiniu.js","webpack:///external \"qiniu\"","webpack:///external \"shelljs\"","webpack:///./server/routes/public \\.js$","webpack:///./server/middleware/rest.js","webpack:///./server/middleware/restful/index.js","webpack:///./server/middleware/restful/controller.js","webpack:///./server/middleware/router.js","webpack:///./nuxt.config.js"],"names":["Router","require","_","R","symbolPrefix","Symbol","routeMap","Map","isArray","c","Route","app","apiPath","router","context","keys","forEach","key","conf","controller","controllers","prefixPath","target","normalizePath","routerPath","path","method","use","routes","allowedMethods","loadRouter","startsWith","descriptor","set","prototype","get","post","put","del","all","decorate","args","middleware","unshift","convert","auth","ctx","next","console","log","session","user","body","success","code","err","admin","role","roel","roleExpected","required","errors","checkRules","forEachObjIndexed","value","filter","has","i","request","rules","length","join","host","process","env","HOST","assign","ArticleService","article","Article","mongoose","model","ArticleType","articleHandlerController","params","addLiker","msg","error","_id","query","username","userid","fetchDetail","data","status","subLiker","addComment","findOne","name","groupType","__v","password","content","find","isTop","sort","limit","populate","select","topArticles","type","$ne","latestArticles","groupArticles","aggregate","$match","$group","articles","$push","title","desc","cover","clickNum","likeNum","$size","commentNum","pubdate","minaController","js_code","openidAndSessionKey","config","port","PORT","MIDDLEWARES","useMiddlewares","keyList","basename","k","midName","info","initWith","Server","dev","nuxt","builder","build","req","Promise","resolve","reject","res","on","render","promise","then","catch","listen","start","getFilename","reg","exec","jwt","signatrue","jwt_secret","debug","regx","payload","authentication","needAuth","every","r","test","url","token","resolveAuthorizationHeader","throw","verify","message","header","authorization","parts","split","scheme","credentials","decoded","Enforcer","BasicAuthorizer","enforcer","originalUrl","getUserName","enforce","authz","newEnforcer","needAuthz","Error","authzorizer","checkPermission","addLogger","koaLogger","addStatic","koaStatic","__dirname","addCORS","cors","addBody","KoaBody","addSession","CONFIG","maxAge","overwrite","signed","rolling","add401Handler","plugin","modelDir","database","connect","db","useNewUrlParser","connection","User","email","save","countDocuments","typeLenght","typeList","insertMany","module","exports","MetaPlugin","schema","options","pre","isNew","meta","createdAt","updatedAt","Date","now","Schema","Types","Mixed","ObjectId","ArticleSchema","String","default","Number","openness","Boolean","ref","author","tags","likeList","avatar","commentList","virtual","virtuals","ArticleTagSchema","ArticleTypeSchema","bcrypt","SALT_WORK_FACTOR","MAX_LOGIN_ATTEMPTS","LOCK_TIME","UserSchema","unique","lockUntil","loginAttempts","isModified","genSalt","salt","hash","methods","comparePassword","_password","compare","isMatch","incLoginAttempts","update","$set","$unset","updates","$inc","isLockde","initPublic","adminController","ret","adminService","login","matchData","match","db_id","db_username","TOKEN","sign","expiresIn","sign_key","id","mobile","page","size","where","skip","fetchList","lean","entity","isLike","isHas","some","create","Object","remove","push","targetId","result","Model","articleController","xss","articleTag","articleType","opts","uri","qs","appid","mina","secret","grant_type","json","rp","WXBizDataCrypt","sessionKey","appId","encryptedData","iv","Buffer","decipher","crypto","createDecipheriv","setAutoPadding","final","JSON","parse","watermark","QiniuController","mac","qiniu","digest","Mac","AK","SK","scope","bucket","putPolicy","rs","PutPolicy","uploadToken","uptoken","fetchImage","bash","child","async","stdout","restfulRouter","addRestful","rest","prefix","skipMid","str","tab","indexOf","getModel","strict","_where","_sort","parseInt","_skip","_limit","_populate","_regex","RegExp","_lt","$lt","_lte","$lte","_gt","$gt","_gte","$gte","_ne","doc","init","head","charset","hid","link","rel","href","css","src","plugins","ssr","loading","NODE_ENV","cache","max","vendor","extend","client"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c8f0f134a7d2ddd3faa2","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","const Router = require('koa-router')\n// const { resolve } = require('path')\n// const glob = require('glob')\nconst _ = require('lodash')\nconst R = require('ramda')\n\n// import { jwtMiddleware } from '../middleware/jwt'\n// import config from '../config/index'\n\n// const jwt = jwtMiddleware({ signatrue: config.jwt_secret, debug: true })\n\nconst symbolPrefix = Symbol('prefix')\nconst routeMap = new Map()\n\nconst isArray = c => (_.isArray(c) ? c : [c])\n\nexport class Route {\n  constructor(app, apiPath) {\n    this.app = app\n    this.apiPath = apiPath\n    this.router = new Router()\n  }\n\n  init() {\n    // const regx = /^\\.\\/public\\//    // 过滤public目录下的公共路由\n    // glob.sync(resolve(this.apiPath, './**/*.js')).forEach(require)\n    // Todo: 待修复require.context不支持绝对路径问题\n    const context = require.context('../routes', true, /\\.js$/)\n    // 先把所有路由均加入，待会用koa-unless跳过执行中间件\n    context.keys().forEach(key => context(key))\n    // context.keys().filter(i => !regx.test(i)).forEach(key => context(key))\n\n    // 为所有中间件注册路由\n    for (let [conf, controller] of routeMap) {\n      const controllers = isArray(controller)\n      const prefixPath = conf.target[symbolPrefix]\n      if (prefixPath) prefixPath = normalizePath(prefixPath)\n      const routerPath = prefixPath + conf.path\n      this.router[conf.method](routerPath, ...controllers)\n      //this.router[conf.method](routerPath, jwt, ...controllers)\n    }\n    this.app\n      .use(this.router.routes())\n      .use(this.router.allowedMethods())\n  }\n\n  initPublic() {\n    // 注册公开路由\n    const context = require.context('../routes/public', true, /\\.js$/)\n    context.keys().forEach(key => context(key))\n\n    this.loadRouter()\n  }\n\n  loadRouter() {}\n}\n\n// 如果是根路径就直接访问，如果不是就接着访问\nconst normalizePath = path => (path.startsWith('/') ? path : `/${path}`)\n\nconst router = conf => (target, key, descriptor) => {\n  conf.path = normalizePath(conf.path)\n\n  routeMap.set(\n    {\n      target,\n      ...conf\n    },\n    target[key]\n  )\n}\n\n// export 利用symbol创建唯一值在类的原型上\nexport const controller = path => target =>\n  (target.prototype[symbolPrefix] = path)\n\nexport const get = path =>\n  router({\n    method: 'get',\n    path\n  })\n\nexport const post = path =>\n  router({\n    method: 'post',\n    path\n  })\n\nexport const put = path =>\n  router({\n    method: 'put',\n    path\n  })\n\nexport const del = path =>\n  router({\n    method: 'delete',\n    path\n  })\n\nexport const use = path =>\n  router({\n    method: 'use',\n    path\n  })\n\nexport const all = path =>\n  router({\n    method: 'all',\n    path\n  })\n\nconst decorate = (args, middleware) => {\n  let [target, key, descriptor] = args\n\n  target[key] = isArray(target[key])\n  target[key].unshift(middleware)\n\n  return descriptor\n}\n\nconst convert = middleware => (...args) => decorate(args, middleware)\n\n// const changeToArr = R.unless(\n//   R.is(isArray),\n//   R.of\n// )\n\n// const convert = middleware => (target, key, descriptor) => {\n//   return (target, key, descriptor) => {\n//     target[key] = R.compose(\n//       R.concat(\n//         changeToArr(middleware)\n//       ),\n//       changeToArr\n//     )(target[key])\n//   }\n// }\n\nexport const auth = convert(async (ctx, next) => {\n  console.log('进来auth装饰器了咩？')\n  if (!!!ctx.session || !ctx.session.user) {\n    return (ctx.body = {\n      success: false,\n      code: 401,\n      err: '登录失效，重新登录'\n    })\n  }\n\n  await next()\n})\n\nexport const admin = roleExpected =>\n  convert(async (ctx, next) => {\n    const { role } = ctx.session.user\n\n    //Todo: casbin\n\n    if (!roel || role !== roleExpected) {\n      return (ctx.body = {\n        success: false,\n        code: 403,\n        err: '无权限'\n      })\n    }\n\n    await next()\n  })\n\nexport const required = rules =>\n  convert(async (ctx, next) => {\n    let errors = []\n\n    const checkRules = R.forEachObjIndexed((value, key) => {\n      errors = R.filter(i => !R.has(i)(ctx.request[key]))(value)\n    })\n\n    checkRules(rules)\n\n    if (errors.length) {\n      return (ctx.body = {\n        success: false,\n        code: 412,\n        err: `${errors.join(',')} is required`\n      })\n    }\n\n    await next()\n  })\n\n\n\n// WEBPACK FOOTER //\n// ./server/lib/decorator.js","import _ from 'lodash'\n// import { resolve } from 'path'\n\nconst host = process.env.HOST || 'localhost'\nconst env = process.env.NODE_ENV || 'development'\n\n// const confPath = resolve(__dirname, `./${env}.json`)\n\n// 同步加载json配置文件\nconst conf = require(`./${env}.json`)\n\n// 用lodash合并\nexport default _.assign({ env, host }, conf)\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","import * as admin from './admin'\nimport * as article from './article'\nimport * as articleTag from './articleTag'\nimport * as articleType from './articleType'\n\nexport {\n  admin,\n  article,\n  articleTag,\n  articleType,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/service/index.js","module.exports = require(\"xss\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"xss\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"ramda\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ramda\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 10\n// module chunks = 0","import xss from 'xss'\nimport mongoose from 'mongoose'\n\nconst { article: ArticleService } = require('../../service')\n\nconst { controller, get, del, put, post, required } = require('../../lib/decorator')\nconst Article = mongoose.model('Article')\nconst ArticleType = mongoose.model('ArticleType')\n\n@controller('/api/public/article')\nexport class articleHandlerController {\n  @post('/like')\n  async postLike(ctx) {\n    // must contain: _id, username, userid\n    let params = ctx.request.body\n    try {\n      await ArticleService.addLiker(params)\n\n      ctx.body = {\n        msg: '点赞成功',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @get('/detail/:_id')\n  async detail(ctx) {\n    const { _id } = ctx.params\n\n    const { username, userid } = ctx.query\n    try {\n      const data = await ArticleService.fetchDetail({ _id, username, userid })\n\n      ctx.body = {\n        success: true,\n        data\n      }\n    } catch (err) {\n      ctx.status = 400\n      ctx.body = {\n        success: false,\n        msg: '请求参数有误'\n      }\n    }\n  }\n\n  @post('/unlike')\n  async postUnLike(ctx) {\n    // must contain: _id, username, userid\n    let params = ctx.request.body\n\n    try {\n      await ArticleService.subLiker(params)\n\n      ctx.body = {\n        msg: '取消点赞',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @post('/comment')\n  async postComment(ctx) {\n    // must contain: _id, username, userid, avatar, content\n    let params = ctx.request.body\n\n    try {\n      await ArticleService.addComment(params)\n\n      ctx.body = {\n        msg: '评论成功',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @get('/homeArticles')\n  async getHomeArticles(ctx) {\n    // TODO: redis缓存公共业务数据，不能让ODM每次都去查\n    const groupType = await ArticleType.findOne({ name: '集团新闻' })\n    const filter = { __v: 0, password: 0, content: 0 }\n    // 查询 置顶文章\n    let topArticles = await Article\n      .find({ status: 9, isTop: true }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    // 查询 最新文章：审核状态 and 不等于[集团新闻]类别 and 不是轮播文章\n    let latestArticles = await Article\n      .find({ status: 9, type: { $ne: groupType._id }, isTop: false }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    // 查询 集团新闻\n    let groupArticles = await Article\n      .find({ status: 9, type: groupType._id, isTop: false }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    ctx.body = {\n      success: true,\n      data: {\n        topArticles,\n        latestArticles,\n        groupArticles\n      }\n    }\n  }\n\n  @get('/groupArticles')\n  async getGroupArticles(ctx) {\n    // let data = await Article\n    // .aggregate([\n    //   { $match: { status: 9 } },\n    //   { $group: { _id: '$type', articles: {$push: '$$ROOT'}} },\n    //   { $project: { 'articles.likeNum': { $size: '$likeList' } ,'articles.isTop': 0, 'articles.openness': 0, 'articles.author': 0, 'articles.type': 0, 'articles.__v': 0, 'articles.content': 0, 'articles.password': 0, 'articles.tags': 0}}\n    // ])\n\n    let data = await Article\n      .aggregate([\n        { $match: { status: 9 } },\n        {\n          $group: {\n            _id: '$type', articles: {\n              $push: {\n                _id: '$_id',\n                title: '$title',\n                desc: '$desc',\n                cover: '$cover',\n                clickNum: '$clickNum',\n                likeNum: { $size: '$likeList' },\n                commentNum: { $size: '$commentList' },\n                pubdate: '$pubdate'\n              }\n            }\n          }\n        }\n      ])\n\n    data = await Article.populate(data, {\n      path: '_id',\n      model: 'ArticleType',\n      select: '_id name'\n    })\n\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/public/article.js","import { openidAndSessionKey } from '../../wechat-lib/mina'\nconst { controller, get, del, put, post, required } = require('../../lib/decorator')\n\n@controller('/api/public/mina')\nexport class minaController {\n  @get('/openidAndSessionKey')\n  async getOpenID(ctx) {\n    const { js_code } = ctx.query\n    try {\n      const data = await openidAndSessionKey(js_code)\n\n      ctx.body = {\n        success: true,\n        data\n      }\n    } catch (err) {\n      ctx.status = 400\n      ctx.body = {\n        success: false,\n        msg: '请求参数有误'\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/public/mina.js","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\nimport Router from 'koa-router'\nimport R from 'ramda'\nimport { getFilename } from './utils'\nimport config from './config'\nimport { basename } from 'path'\n\nconst host = config.HOST || process.env.HOST || '0.0.0.0'\nconst port = config.PORT || process.env.PORT || 3000\n\n// const MIDDLEWARES = ['database', 'common', 'rest', 'pubRouter', 'router'] , 'authorization'\nconst MIDDLEWARES = ['database', 'common', 'authentication', 'authorization', 'router']\n\n// 自动遍历 ./middleware/*.js 导出对象后再逐个遍历初始化koa中间件\nconst useMiddlewares = app => {\n  // 不递归加载子目录\n  const context = require.context('./middleware/', false, /\\.js$/)\n  const keyList = context.keys()\n  // R.map(\n  //   R.compose(\n  //     filename => MIDDLEWARES.includes(filename),\n  //     key => getFilename(key)\n  //   )\n  // )(context.keys())\n\n  //重构中间件加载流程\n  MIDDLEWARES.forEach(midName => {\n    const key = keyList.filter(k => basename(k, '.js') === midName)\n\n    if (key) {\n      console.info('加载系统中间件:', key)\n      try {\n        R.forEachObjIndexed(initWith => initWith(app))(context(key))\n      } catch (err) {\n        console.error(err)\n      }\n    }\n  })\n\n  // context.keys().forEach(key => {\n  //   const filename = getFilename(key)\n  //   //console.log('filename~~~', filename)\n  //   const isValid = MIDDLEWARES.includes(filename)\n  //   if (isValid) {\n  //     //console.log('成功加载系统中间件:', filename)\n  //     try {\n  //       R.forEachObjIndexed(initWith => initWith(app))(context(key))\n  //     } catch (err) {\n  //       console.error(err)\n  //     }\n  //   }\n  // })\n}\n\nclass Server {\n  constructor() {\n    this.app = new Koa()\n    useMiddlewares(this.app)\n  }\n\n  async start(host, port) {\n    // Import and Set Nuxt.js options\n    let config = require('../nuxt.config.js')\n    config.dev = !(process.env.NODE_ENV === 'production')\n    // console.log('env === ', app.env, env, process.env.COOKIE_DOMAIN, process.env.APP_ENV, config.dev)\n\n    // Instantiate nuxt.js\n    const nuxt = new Nuxt(config)\n\n    // Build in development\n    if (config.dev) {\n      const builder = new Builder(nuxt)\n      await builder.build()\n    }\n\n    this.app.use(async (ctx, next) => {\n      await next()\n      ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n      ctx.req.session = ctx.session // 必须将session添加进request中，否则nuxt的req获取不到session\n      return new Promise((resolve, reject) => {\n        ctx.res.on('close', resolve)\n        ctx.res.on('finish', resolve)\n        nuxt.render(ctx.req, ctx.res, promise => {\n          // nuxt.render passes a rejected promise into callback on error.\n          promise.then(resolve).catch(reject)\n        })\n      })\n    })\n\n    this.app.listen(port, host)\n    console.log('Server listening on http://' + host + ':' + port) // eslint-disable-line no-console\n  }\n}\n\ntry {\n  const app = new Server()\n  app.start(host, port)\n} catch (err) {\n  console.error(err)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 16\n// module chunks = 0","export const getFilename = path => {\n  const reg = /\\/(\\w+).js$/\n  const res = reg.exec(path)\n  return res && res[1]\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/utils/index.js","var map = {\n\t\"./development.example.json\": 19,\n\t\"./development.json\": 20,\n\t\"./production.example.json\": 21,\n\t\"./production.json\": 22\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 18;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config ^\\.\\/.*\\.json$\n// module id = 18\n// module chunks = 0","module.exports = {\"db\":\"mongodb://localhost:27017/jerryServ\",\"SITE_ROOT_URL\":\"https://jj.jerryshi.com\",\"qiniu\":{\"AK\":\"\",\"SK\":\"\",\"bucket\":\"\",\"qiniuURL\":\"\",\"config\":{\"useCdnDomain\":true}},\"mina\":{\"appid\":\"\",\"secret\":\"\"},\"jwt_secret\":\"\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/development.example.json\n// module id = 19\n// module chunks = 0","module.exports = {\"HOST\":\"0.0.0.0\",\"PORT\":3000,\"db\":\"mongodb://localhost:27017/jerryServ\",\"SITE_ROOT_URL\":\"http://jj.jerryshi.com\",\"qiniu\":{\"AK\":\"OiUlP0RxLh1eN318uvFvX4AyHeRfAGOiPmnNwdGx\",\"SK\":\"Meii5goUxxczCkctM3vM3dgdQTU5r7YwOzHeIocE\",\"bucket\":\"myblog\",\"qiniuURL\":\"http://cdn.jerryshi.com/\",\"config\":{\"useCdnDomain\":true}},\"mina\":{\"appid\":\"wxdaea0300fe209fa9\",\"secret\":\"864ac28f6b80ee241ccaf0d2924e4421\"},\"jwt_secret\":\"aXUPaeWgdcj@SW&5\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/development.json\n// module id = 20\n// module chunks = 0","module.exports = {\"db\":\"mongodb://localhost:27017/jerryServ\",\"SITE_ROOT_URL\":\"https://jerryshi.com\",\"qiniu\":{\"AK\":\"\",\"SK\":\"\",\"bucket\":\"\",\"qiniuURL\":\"\",\"config\":{\"useCdnDomain\":true}},\"mina\":{\"appid\":\"\",\"secret\":\"\"},\"jwt_secret\":\"\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/production.example.json\n// module id = 21\n// module chunks = 0","module.exports = {\"HOST\":\"0.0.0.0\",\"PORT\":3003,\"db\":\"mongodb://localhost:27017/jerryServ\",\"SITE_ROOT_URL\":\"http://jj.jerryshi.com\",\"qiniu\":{\"AK\":\"OiUlP0RxLh1eN318uvFvX4AyHeRfAGOiPmnNwdGx\",\"SK\":\"Meii5goUxxczCkctM3vM3dgdQTU5r7YwOzHeIocE\",\"bucket\":\"myblog\",\"qiniuURL\":\"http://cdn.jerryshi.com/\",\"config\":{\"useCdnDomain\":true}},\"mina\":{\"appid\":\"wxdaea0300fe209fa9\",\"secret\":\"864ac28f6b80ee241ccaf0d2924e4421\"},\"jwt_secret\":\"\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/config/production.json\n// module id = 22\n// module chunks = 0","var map = {\n\t\"./authentication.js\": 24,\n\t\"./authorization.js\": 25,\n\t\"./common.js\": 27,\n\t\"./database.js\": 33,\n\t\"./pubRouter.js\": 42,\n\t\"./rest.js\": 61,\n\t\"./router.js\": 64\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 23;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/middleware nonrecursive \\.js$\n// module id = 23\n// module chunks = 0","// Authentication 鉴权 和 Authorization 授权\nimport config from '../config'\nconst jwt = require('jsonwebtoken')\n\nconst signatrue = config.jwt_secret\nconst debug = config.env === 'development'\n// 只鉴权/api/ 开头 但不包括 public和login\nconst regx = [/^\\/api\\//i, /^(?!\\/api\\/public\\/)/i, /^(?!\\/api\\/admin\\/login)/i]\nlet payload\n\nexport const authentication = app => {\n  app.use(async (ctx, next) => {\n    const needAuth = regx.every(r => r.test(ctx.url))\n    // console.log(ctx.url, '需要鉴权吗【', needAuth, ' 】')\n\n    if (needAuth) {\n      const token = resolveAuthorizationHeader(ctx)\n\n      if (!token) {\n        ctx.throw(401, debug ? 'Token not found' : 'Authentication Error')\n      }\n      if (!signatrue) {\n        ctx.throw(500, debug ? 'Signatrue not found' : 'Authentication Error')\n      }\n\n      try {\n        payload = await verify(token, signatrue)\n\n        ctx.jwt = payload\n      } catch (err) {\n        const msg = debug ? err.message : 'Authentication Error'\n        ctx.throw(401, msg)\n      }\n    }\n\n    await next()\n  })\n}\n\nfunction resolveAuthorizationHeader(ctx) {\n  if (!ctx.header || !ctx.header.authorization) {\n    return (\n      ctx.throw(400, 'Bad Rquest')\n    )\n  }\n\n  const parts = ctx.header.authorization.split(' ')\n\n  if (parts.length === 2) {\n    const scheme = parts[0]\n    const credentials = parts[1]\n\n    if (/^Bearer$/i.test(scheme)) {\n      return credentials\n    }\n  }\n\n  ctx.throw(\n    401,\n    'Bad Authorization header format. Format is \"Authorization: Bearer <token>\"'\n  )\n}\n\nfunction verify(token, signatrue) {\n  return new Promise((resolve, reject) => {\n    jwt.verify(token, signatrue, (error, decoded) => {\n      error ? reject(error) : resolve(decoded)\n    })\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/authentication.js","const { Enforcer } = require('casbin')\n\nconst regx = [/^\\/api\\//i, /^(?!\\/api\\/public\\/)/i, /^(?!\\/api\\/admin\\/login)/i]\n\n// BasicAuthorizer class stores the casbin handler\nclass BasicAuthorizer {\n  constructor(ctx, enforcer) {\n    this.ctx = ctx\n    this.enforcer = enforcer\n  }\n\n  getUserName() {\n    // customize to get username from context\n    const { username } = this.ctx.jwt\n\n    return username || ''\n  }\n\n  // checkPermission checks the user/method/path combination from the request.\n  // Returns true (permission granted) or false (permission forbidden)\n  checkPermission() {\n    const { ctx, enforcer } = this\n    const { originalUrl: path, method } = ctx\n    const user = this.getUserName()\n\n    return enforcer.enforce(user, path, method)\n  }\n}\n\n// authz returns the authorizer, uses a Casbin enforcer as input\nfunction authz(newEnforcer) {\n  return async (ctx, next) => {\n    const needAuthz = regx.every(r => r.test(ctx.url))\n    if(needAuthz) {\n      try {\n        const enforcer = await newEnforcer()\n        if (!(enforcer instanceof Enforcer)) {\n          throw new Error('Invalid enforcer')\n        }\n        const authzorizer = new BasicAuthorizer(ctx, enforcer)\n\n        if (!authzorizer.checkPermission()) {\n          ctx.status = 403\n        } else {\n          await next()\n        }\n      } catch (e) {\n        throw e\n      }\n    } else {\n      await next()\n    }\n    \n  }\n}\n\nexport const authorization = app => {\n  // use authz middleware\n  app.use(authz(async () => {\n    // load the casbin model and policy from files, database is also supported.\n    const enforcer = await Enforcer.newEnforcer(\"server/middleware/authz/authz_model.conf\", \"server/middleware/authz/authz_policy.csv\")\n    return enforcer\n  }))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/authorization.js","module.exports = require(\"casbin\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"casbin\"\n// module id = 26\n// module chunks = 0","import KoaBody from 'koa-bodyparser'\nimport koaLogger from 'koa-logger'\nimport session from 'koa-session'\nimport cors from '@koa/cors'\nimport koaStatic from 'koa-static'\nimport path from 'path'\n\nexport const addLogger = app => {\n  app.use(koaLogger())\n}\n\nexport const addStatic = app => {\n  // 配置静态资源加载中间件\n  app.use(koaStatic(path.join(__dirname, '../static')))\n}\n\nexport const addCORS = app => {\n  app.use(cors())\n}\n\nexport const addBody = app => {\n  app.use(KoaBody())\n}\n\nexport const addSession = app => {\n  app.keys = ['ice']\n\n  const CONFIG = {\n    key: 'koa:sess',\n    maxAge: 86400000,\n    overwrite: true,\n    signed: true,\n    rolling: false\n  }\n  app.use(session(CONFIG, app))\n}\n\n// Custom 401 handling\n// 前置捕捉401错误，就是因为koa才可以前置 error-handler\nexport const add401Handler = app => {\n  app.use((ctx, next) => {\n    return next().catch(err => {\n      if (401 == err.status) {\n        ctx.status = 401\n        ctx.body = {\n          success: false,\n          msg: '401 Unauthorized'\n        }\n      } else {\n        console.error(err)\n        throw err\n      }\n    })\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/common.js","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"koa-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-logger\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"koa-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-session\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"@koa/cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@koa/cors\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 32\n// module chunks = 0","import fs from 'fs'\nimport { resolve } from 'path'\nimport mongoose from 'mongoose'\nimport config from '../config'\n\n// loading mogoose \"meta\" plugins\nmongoose.plugin(require('../database/plugins/meta'))\n\nconst modelDir = resolve(__dirname, '../database/schema')\n\n// fs\n//   .readdirSync(modelDir)\n//   .filter(file => ~file.search(/\\.js$/))    // only .js file\n//   .forEach(file => require(resolve(modelDir, file)))\n\nconst context = require.context('../database/schema', true, /\\.js$/)\ncontext.keys().forEach(key => context(key))\n\nexport const database = app => {\n  mongoose.set('debug', true)\n\n  mongoose.connect(config.db, { useNewUrlParser: true })\n\n  mongoose.connection.on('disconnected', () => {\n    mongoose.connect(config.db)\n  })\n\n  mongoose.connection.on('error', err => {\n    console.error(err)\n  })\n\n  mongoose.connection.on('open', async () => {\n    console.info('Connected to MongoDB ', config.db)\n\n    // TODO: \n    const User = mongoose.model('User')\n    let user = await User.findOne({\n      username: 'admin'\n    }).exec()\n\n    if (!user) {\n      user = new User({\n        username: 'admin',\n        password: 'admin888',\n        email: 'admin@126.com'\n      })\n      console.info('[Info] 写入管理员数据初始化数据')\n    }\n    await user.save()\n\n    ////////////////\n    const ArticleType = mongoose.model('ArticleType')\n    const typeLenght = await ArticleType.find().countDocuments().exec()\n\n    if (typeLenght === 0) {\n      let typeList = [\n        {\n          name: '产业职教'\n        },\n        {\n          name: '校企合作'\n        },\n        {\n          name: '校园安全'\n        },\n        {\n          name: '资源干货'\n        },\n        {\n          name: '集团新闻'\n        },\n        {\n          name: '选学校'\n        },\n        {\n          name: '选企业'\n        },\n        {\n          name: '化育明珠'\n        },\n        {\n          name: '现代课堂'\n        }\n      ]\n      await ArticleType.insertMany(typeList)\n      console.info('[Info] 写入ArticleType初始化数据')\n    }\n  })\n}\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/database.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 34\n// module chunks = 0","module.exports = exports = function MetaPlugin(schema, options) {\n  // 完全就是连锁反应 subDocument也会触发这个中间件!\n  schema.pre('save', function (next) {\n    if (this.isNew) {\n      this.meta = {} // 不能给访问undefined的属性\n      this.meta.createdAt = this.meta.updatedAt = Date.now()\n    } else {\n      // find 也会执行\n      this.meta.updatedAt = Date.now()\n    }\n\n    next()\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/plugins/meta.js","var map = {\n\t\"./article.js\": 37,\n\t\"./articleTag.js\": 38,\n\t\"./articleType.js\": 39,\n\t\"./user.js\": 40\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 36;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/database/schema \\.js$\n// module id = 36\n// module chunks = 0","const mongoose = require('mongoose')\nconst Schema = mongoose.Schema\nconst { Mixed, ObjectId } = Schema.Types\n\nconst ArticleSchema = new Schema({\n  title: {\n    type: String,\n    required: true\n  },\n  cover: String,\n  desc: String,\n  pubdate: {\n    type: Date,\n    default: Date.now()\n  },\n  content: String,\n  status: Number,\n  openness: String,\n  isTop: Boolean,\n  password: String,\n  type: {\n    type: ObjectId,\n    ref: 'ArticleType'\n  },\n  author: {\n    type: ObjectId,\n    ref: 'User'\n  },\n  tags: [\n    {\n      type: ObjectId,\n      ref: 'ArticleTag'\n    }\n  ],\n  likeList: [\n    {\n      username: String,\n      avatar: String,\n      userid: String,\n      meta: {\n        createdAt: {\n          type: Date,\n          default: Date.now()\n        },\n        updatedAt: {\n          type: Date,\n          default: Date.now()\n        }\n      }\n    }\n  ],\n  commentList: [\n    {\n      username: String,\n      avatar: String,\n      userid: String,\n      content: String,\n      meta: {\n        createdAt: {\n          type: Date,\n          default: Date.now()\n        },\n        updatedAt: {\n          type: Date,\n          default: Date.now()\n        }\n      }\n    }\n  ],\n  clickNum: {\n    type: Number,\n    default: 0\n  },\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nArticleSchema.virtual('likeNum').get(function () {\n  return this.likeList.length || 0\n})\n\nArticleSchema.virtual('commentNum').get(function () {\n  return this.commentList.length || 0\n})\n\nArticleSchema.set('toJSON', { virtuals: true })\nArticleSchema.set('toObject', { virtuals: true })\n\n// ArticleSchema.pre('find', function (next) {\n//   console.log('我是pre方法1')\n//   console.log(this)\n//   next()\n// })\n\nmongoose.model('Article', ArticleSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/article.js","const mongoose = require('mongoose')\nconst Schema = mongoose.Schema\n\nconst ArticleTagSchema = new Schema({\n  name: {\n    type: String,\n    required: true \n  },\n  desc: String,\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nmongoose.model('ArticleTag', ArticleTagSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/articleTag.js","const mongoose = require('mongoose')\nconst Schema = mongoose.Schema\n\nconst ArticleTypeSchema = new Schema({\n  name: {\n    type: String,\n    required: true \n  },\n  desc: String,\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nmongoose.model('ArticleType', ArticleTypeSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/articleType.js","const mongoose = require('mongoose')\nconst bcrypt = require('bcrypt')\nconst Schema = mongoose.Schema\n\nconst SALT_WORK_FACTOR = 10\nconst MAX_LOGIN_ATTEMPTS = 5\nconst LOCK_TIME = 2 * 60 * 60 * 1000\n\nconst UserSchema = new Schema({\n  username: {\n    unique: true,\n    required: true,\n    type: String\n  },\n  email: {\n    unique: true,\n    required: true,\n    type: String\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatar: {\n    type: String,\n    default: 'http://cdn.jerryshi.com/picgo/20180819213615.png'\n  },\n  role: {\n    type: String,\n    default: 'user'\n  },\n  lockUntil: Number,\n  loginAttempts: {\n    type: Number,\n    required: true,\n    default: 0\n  },\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nUserSchema.virtual('isLocked').get(function () {\n  return !!(this.lockUntil && this.lockUntil > Date.now())  // 取两次反转boolean\n})\n\nUserSchema.pre('save', function (next) {\n  if (!this.isModified('password')) return next()\n\n  // 使用第三方库构建盐\n  bcrypt.genSalt(SALT_WORK_FACTOR, (err, salt) => {\n    // 如果构建盐失败返回\n    if (err) return next(err)\n    // 尝试用盐加密\n    bcrypt.hash(this.password, salt, (error, hash) => {\n      // 加密失败抛出去\n      if (error) return next(err)\n\n      this.password = hash\n      // 交出控制权\n      next()\n    })\n  })\n})\n\nUserSchema.methods = {\n  // _password为网站提交来的明文password，第二个就是数据库中加盐后的hash密码\n  comparePassword: (_password, password) => {\n    return new Promise((resolve, reject) => {\n      bcrypt.compare(_password, password, (err, isMatch) => {\n        if (!err) resolve(isMatch)\n        else reject(err)\n      })\n    })\n  },\n\n  incLoginAttempts: (user) => {\n    return new Promise((resolve, reject) => {\n      if (this.lockUntil && this.lockUntil < Date.now()) {\n        this.update({\n          $set: {  // 原来mongoose的$set+$unset就是个原子操作\n            loginAttempts: 1\n          },\n          $unset: {\n            lockUntil: 1\n          }\n        }, (err) => {\n          if (!err) resolve(true)\n          else reject(err)\n        })\n      } else {\n        let updates = {\n          $inc: {\n            loginAttempts: 1\n          }\n        }\n\n        if (this.loginAttempts + 1 >= MAX_LOGIN_ATTEMPTS && !this.isLockde) {\n          updates.$set = {\n            lockUntil: Date.now() + LOCK_TIME\n          }\n        }\n\n        this.update(updates, err => {\n          if (!err) resolve(true)\n          else reject(err)\n        })\n      }\n    })\n  }\n}\n\nmongoose.model('User', UserSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/user.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 41\n// module chunks = 0","const { Route } = require('../lib/decorator')\n\nexport const router = app => {\n  // const apiPath = resolve(__dirname, '../routes')\n  // Todo: 待修复，现在只能传字面量的问题\n  const router = new Route(app, '../routes/public')\n\n  router.initPublic()\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/pubRouter.js","var map = {\n\t\"./admin.js\": 44,\n\t\"./article.js\": 49,\n\t\"./articleHandler.js\": 50,\n\t\"./articleTag.js\": 51,\n\t\"./articleType.js\": 52,\n\t\"./public/article.js\": 11,\n\t\"./public/mina.js\": 12,\n\t\"./qiniu.js\": 56\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 43;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/routes \\.js$\n// module id = 43\n// module chunks = 0","import jwt from 'jsonwebtoken'\nimport config from '../config'\nimport { admin as adminService } from '../service'\nconst {\n  controller,\n  get,\n  del,\n  post,\n  auth,\n  admin,\n  required\n} = require('../lib/decorator')\n\n@controller('/api/admin')\nexport class adminController {\n  @get('/user')\n  async getUser(ctx, next) {\n    ctx.body = {\n      ret: 200,\n      msg: '获取成功',\n      data: { username: 'jerry', name: 'jerry' }\n    }\n  }\n\n  @post('/login')\n  @required({\n    body: ['username', 'password']\n  })\n  async login(ctx) {\n    const { username, password } = ctx.request.body\n    const matchData = await adminService.login(username, password)\n\n    if (!matchData.user) {\n      return (ctx.body = {\n        ret: 403,\n        success: false,\n        msg: '用户不存在'\n      })\n    }\n\n    if (matchData.match) {\n      const { _id: db_id, username: db_username } = matchData.user\n      // 验证成功：使用jwt发放token\n      const TOKEN = jwt.sign({ username: db_username }, config.jwt_secret, { expiresIn: '2h' })\n      \n      ctx.session.user = {\n        _id: db_id,\n        username: db_username,\n        token: TOKEN,\n        sign_key: '4444',\n        info: {\n          id: db_id,\n          mobile: '138',\n          name: db_username,\n          status: 1\n        }\n      }\n      // TODO: 待重构登录逻辑\n      return (ctx.body = {\n        success: true,\n        ret: 200,\n        msg: '请求成功',\n        data: {\n          code: 0,\n          message: '登录成功',\n          token: TOKEN,\n          info: {\n            name: db_username,\n            mobile: '13988889999',\n            _id: db_id,\n            username: db_username\n          }\n        }\n      })\n    }\n\n    ctx.body = {\n      ret: 403,\n      success: false,\n      msg: '用户名或密码不正确'\n    }\n  }\n\n  @post('/logout')\n  async logout(ctx) {\n    try {\n      ctx.session.user = null\n      return (ctx.body = {\n        ret: 200,\n        msg: '请求成功',\n        data: {\n          code: 0,\n          message: '退出成功'\n        }\n      })\n    } catch (e) {\n      return (ctx.body = {\n        ret: 200,\n        msg: '请求成功',\n        data: {\n          code: -1,\n          message: '退出失败'\n        }\n      })\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/admin.js","import mongoose from 'mongoose'\nconst User = mongoose.model('User')\n\nexport async function login(username, password) {\n  let match = false\n  const user = await User.findOne({ username }).exec()\n\n  if (user) {\n    match = await user.comparePassword(password, user.password)\n  }\n  return {\n    match,\n    user\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/service/admin.js","import mongoose from 'mongoose'\nconst Article = mongoose.model('Article')\n\nexport async function fetchList(params) {\n  const { page = 1, size = 20, type, isTop } = params\n  let where = {}\n  if (type) {\n    where['type'] = type\n  }\n  if (isTop) {\n    where['isTop'] = isTop === 'true'\n  }\n  console.log(where)\n  const data = await Article\n    .find(where, { __v: 0, password: 0, content:0 })\n    .skip((page - 1) * size)\n    .limit(Number(size))\n    .sort({ '_id': -1 })\n    .populate({ path: 'type', select: 'name' })\n    .populate({ path: 'tags', select: 'name' })\n    .populate({ path: 'author', select: '_id username avatar' })\n    .exec()\n\n  return data\n}\n\nexport async function fetchDetail({_id, username, userid}) {\n  // TODO: [急]待优化fetchDetail时又自增又lean()问题\n  let entity = await Article.findOne({ _id }, { __v: 0 }).lean()\n  let model = await Article.findOne({ _id }, { __v: 0 })\n  \n  //////////// 待优化 \n  // TODO: 修复lean()方法不包含虚拟字段问题(上中间件mongoose-lean-virtuals还是自己写？)\n  model.clickNum++\n  entity.likeNum = model.likeNum\n  entity.commentNum = model.commentNum\n  ////////////\n  model.save()\n \n  // default value （要不要节省流量不传递呢？）\n  entity.isLike = false\n\n  // 如果 存在点赞人list 且 传了参数 再去编译，节省系统开支\n  if ((entity.likeList.length > 0) && (username || userid)) {\n    const isHas = entity.likeList.some(i => i.username === username || i.userid === userid)\n    if(isHas) {\n      entity.isLike = true\n    }\n  }\n\n  return entity\n}\n\nexport async function create(model) {\n  model = new Article(model)\n  model = await model.save()\n\n  return model\n}\n\nexport async function update(model) {\n  try {\n    let entity = await Article.findOne({ _id: model._id }).exec()\n\n    //TODO: no data\n\n    delete model._id\n    entity = Object.assign(entity, model)\n    entity = await entity.save()\n\n    return entity\n\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nexport async function remove(_id) {\n  const res = await Article.remove({ _id: _id })\n  return res\n}\n\nexport async function addLiker({_id, username, avatar, userid}) {\n  let entity = await Article.findOne({ _id }, { __v: 0 }).exec()\n\n  // 数据服务层不管业务逻辑，业务逻辑交给控制器层\n  entity.likeList.push({username, avatar, userid})\n  entity = await entity.save()\n\n  return entity\n}\n\nexport async function subLiker({_id, username, userid}) {\n  let entity = await Article.findOne({ _id }, { __v: 0 }).exec()\n  // 需要取消点赞的subdocument的_id\n  let targetId = null\n\n  // 遍历subdocument 找到目标id\n  entity.likeList.some(i => {\n    const result = i.username === username || i.userid === userid\n    if(result) {\n      targetId = i._id\n    }\n    return result\n  })\n  // remove subDocument\n  await entity.likeList.id(targetId).remove()  // is prmoise ? TODO:\n  entity = await entity.save()\n\n  return entity\n}\n\nexport async function addComment({_id, username, userid, avatar, content}) {\n  let entity = await Article.findOne({ _id }, { __v: 0 }).exec()\n\n  entity.commentList.push({username, userid, avatar, content})\n  entity = await entity.save()\n\n  return entity\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/service/article.js","import mongoose from 'mongoose'\nconst Model = mongoose.model('ArticleTag')\n\nexport async function fetchList(page = 1, size = 20) {\n  const data = await Model.find().skip((page - 1) * size).limit(Number(size)).sort({ '_id': -1 }).exec()\n\n  return data\n}\n\nexport async function fetchDetail(_id) {\n  const entity = await Model.findOne(_id).exec()\n\n  return entity\n}\n\nexport async function create(model) {\n  model = new Model(model)\n  model = await model.save()\n\n  return model\n}\n\nexport async function update(model) {\n  try {\n    let entity = await Model.findOne({ _id: model._id }).exec()\n\n    //TODO: no data\n\n    delete model._id\n    entity = Object.assign(entity, model)\n    entity = await entity.save()\n\n    return entity\n\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nexport async function remove(_id) {\n  await Model.remove({_id})\n\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/service/articleTag.js","import mongoose from 'mongoose'\nconst Model = mongoose.model('ArticleType')\n\nexport async function fetchList(page = 1, size = 20) {\n  const data = await Model.find().skip((page - 1) * size).limit(Number(size)).sort({ '_id': -1 }).exec()\n\n  return data\n}\n\nexport async function fetchDetail(_id) {\n  const entity = await Model.findOne(_id).exec()\n\n  return entity\n}\n\nexport async function create(model) {\n  model = new Model(model)\n  model = await model.save()\n\n  return model\n}\n\nexport async function update(model) {\n  try {\n    let entity = await Model.findOne({ _id: model._id }).exec()\n\n    //TODO: no data\n\n    delete model._id\n    entity = Object.assign(entity, model)\n    entity = await entity.save()\n\n    return entity\n\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nexport async function remove(_id) {\n  await Model.remove({_id})\n\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/service/articleType.js","import xss from 'xss'\n\nconst { article: Article } = require('../service')\n\nconst { controller, get, del, put, post, required } = require('../lib/decorator')\n\n@controller('/api/article')\nexport class articleController {\n  @get('/')\n  async get(ctx) {\n    // const { page, size, type } = ctx.query\n    const data = await Article.fetchList(ctx.query)\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n\n  @get('/:_id')\n  async detail(ctx) {\n    const { _id } = ctx.params\n\n    const { username, userid } = ctx.query\n\n    const data = await Article.fetchDetail({_id, username, userid})\n\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n\n  @post('/')\n  async post(ctx) {\n    let data = ctx.request.body\n\n    if (!data.pubdate) {\n      data.pubdate = Date.now()\n    }\n\n    // TODO: 修正业务逻辑-根据不同角色用户改变status\n\n    // 默认提交则自动审核\n    if (data.status === 1) {\n      data.status = 9\n    }\n\n    data = {\n      title: xss(data.title),\n      desc: xss(data.desc),\n      cover: xss(data.cover),\n      pubdate: xss(data.pubdate),\n      content: xss(data.content),\n      type: xss(data.type),\n      status: xss(data.status),\n      openness: xss(data.openness),\n      password: xss(data.password),\n      isTop: Boolean(data.isTop),\n      tags: data.tags,\n      author: xss(data.author)\n      // to test\n      // likeList: data.likeList\n    }\n\n    try {\n      data = await Article.create(data)\n      ctx.body = {\n        data,\n        success: true\n      }\n    } catch (err) {\n      ctx.body = {\n        err,\n        success: false\n      }\n    }\n  }\n\n  @put('/')\n  async put(ctx) {\n    let data = ctx.request.body\n    // TODO: 修正业务逻辑-根据不同角色用户改变status\n\n    // 默认提交则自动审核\n    if (data.status === 1) {\n      data.status = 9\n    }\n\n    data = {\n      _id: xss(data._id),\n      title: xss(data.title),\n      desc: xss(data.desc),\n      cover: xss(data.cover),\n      pubdate: xss(data.pubdate),\n      content: xss(data.content),\n      type: xss(data.type),\n      status: xss(data.status),\n      openness: xss(data.openness),\n      password: xss(data.password),\n      isTop: Boolean(data.isTop),\n      tags: data.tags\n    }\n\n    try {\n      data = await Article.update(data)\n      ctx.body = {\n        data,\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n    }\n  }\n\n  @del('/:_id')\n  async delete(ctx) {\n    const { _id } = ctx.params\n    const data = await Article.remove(_id)\n    \n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/article.js","import xss from 'xss'\nimport mongoose from 'mongoose'\n\nconst { article: ArticleService } = require('../service')\n\nconst { controller, get, del, put, post, required } = require('../lib/decorator')\nconst Article = mongoose.model('Article')\nconst ArticleType = mongoose.model('ArticleType')\n\n@controller('/api/articleHandler')\nexport class articleHandlerController {\n  @post('/like')\n  async postLike(ctx) {\n    // must contain: _id, username, userid\n    let params = ctx.request.body\n    try {\n      await ArticleService.addLiker(params)\n\n      ctx.body = {\n        msg: '点赞成功',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @post('/unlike')\n  async postUnLike(ctx) {\n    // must contain: _id, username, userid\n    let params = ctx.request.body\n\n    try {\n      await ArticleService.subLiker(params)\n\n      ctx.body = {\n        msg: '取消点赞',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @post('/comment')\n  async postComment(ctx) {\n    // must contain: _id, username, userid, avatar, content\n    let params = ctx.request.body\n\n    try {\n      const data = await ArticleService.addComment(params)\n\n      ctx.body = {\n        msg: '评论成功',\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n      console.error(error)\n    }\n  }\n\n  @get('/homeArticles')\n  async getHomeArticles(ctx) {\n    // TODO: redis缓存公共业务数据，不能让ODM每次都去查\n    const groupType = await ArticleType.findOne({ name: '集团新闻' })\n    const filter = { __v: 0, password: 0, content: 0 }\n    // 查询 置顶文章\n    let topArticles = await Article\n      .find({ status: 9, isTop: true }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    // 查询 最新文章：审核状态 and 不等于[集团新闻]类别 and 不是轮播文章\n    let latestArticles = await Article\n      .find({ status: 9, type: { $ne: groupType._id }, isTop: false }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    // 查询 集团新闻\n    let groupArticles = await Article\n      .find({ status: 9, type: groupType._id, isTop: false }, filter)\n      .sort({ '_id': -1 })\n      .limit(4)\n      .populate({ path: 'type', select: 'name' })\n      .populate({ path: 'tags', select: 'name' })\n      .populate({ path: 'author', select: '_id username avatar' })\n\n    ctx.body = {\n      success: true,\n      data: {\n        topArticles,\n        latestArticles,\n        groupArticles\n      }\n    }\n  }\n\n  @get('/groupArticles')\n  async getGroupArticles(ctx) {\n    // let data = await Article\n    // .aggregate([\n    //   { $match: { status: 9 } },\n    //   { $group: { _id: '$type', articles: {$push: '$$ROOT'}} },\n    //   { $project: { 'articles.likeNum': { $size: '$likeList' } ,'articles.isTop': 0, 'articles.openness': 0, 'articles.author': 0, 'articles.type': 0, 'articles.__v': 0, 'articles.content': 0, 'articles.password': 0, 'articles.tags': 0}}\n    // ])\n\n    let data = await Article\n      .aggregate([\n        { $match: { status: 9 } },\n        {\n          $group: {\n            _id: '$type', articles: {\n              $push: {\n                _id: '$_id',\n                title: '$title',\n                desc: '$desc',\n                cover: '$cover',\n                clickNum: '$clickNum',\n                likeNum: { $size: '$likeList' },\n                commentNum: { $size: '$commentList' },\n                pubdate: '$pubdate'\n              }\n            }\n          }\n        }\n      ])\n\n    data = await Article.populate(data, {\n      path: '_id',\n      model: 'ArticleType',\n      select: '_id name'\n    })\n\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/articleHandler.js","import xss from 'xss'\n\nconst { articleTag: Model } = require('../service')\n\nconst { controller, get, del, post } = require('../lib/decorator')\n\n@controller('/api/articleTag')\nexport class articleController {\n  @get('/')\n  async get(ctx) {\n    const { page, size } = ctx.query\n    const data = await Model.fetchList(page, size)\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n\n  @post('/')\n  async post(ctx) {\n    let data = ctx.request.body\n\n    data = {\n      name: xss(data.name)\n    }\n\n    try {\n      data = await Model.create(data)\n      ctx.body = {\n        data,\n        success: true\n      }\n    } catch (error) {\n      ctx.body = {\n        error,\n        success: false\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/articleTag.js","import xss from 'xss'\n\nconst {  articleType: Model } = require('../service')\n\nconst { controller, get, del, post } = require('../lib/decorator')\n\n@controller('/api/articleType')\nexport class articleController {\n  @get('/')\n  async get(ctx) {\n    const { page, size } = ctx.query\n    const data = await Model.fetchList(page, size)\n    ctx.body = {\n      success: true,\n      data\n    }\n  }\n\n  @post('/')\n  async post(ctx) {\n    let data = ctx.request.body\n\n    data = {\n      title: xss(data.title),\n      cover: xss(data.title),\n      pubdate: xss(data.pubdate),\n      content: xss(data.content)\n    }\n\n    try {\n      data = await Model.create(data)\n      ctx.body = {\n        data,\n        success: true\n      }\n    } catch (err) {\n      ctx.body = {\n        err,\n        success: false\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/articleType.js","import rp from 'request-promise'\nimport crypto from 'crypto'\nimport config from '../config'\n\nexport const openidAndSessionKey = async code => {\n  let opts = {\n    uri: 'https://api.weixin.qq.com/sns/jscode2session?',\n    qs: {\n      appid: config.mina.appid,\n      secret: config.mina.secret,\n      grant_type: 'authorization_code'\n    },\n    json: true\n  }\n\n  opts.qs.js_code = code\n\n  let res = await rp(opts)\n\n  return res\n}\n\nexport class WXBizDataCrypt {\n  constructor(sessionKey) {\n    this.appId = config.mina.appid\n    this.secret = sessionKey\n  }\n\n  decryptData(encryptedData, iv) {\n    // base64 decode\n    let decoded\n    let sessionKey = new Buffer(this.sessionKey, 'base64')\n    encryptedData = new Buffer(encryptedData, 'base64')\n    iv = new Buffer(iv, 'base64')\n\n    try {\n      // 解密\n      let decipher = crypto.createDecipheriv('aes-128-cbc', sessionKey, iv)\n      // 设置自动 padding 为 true，删除填充补位\n      decipher.setAutoPadding(true)\n      decoded = decipher.update(encryptedData, 'binary', 'utf8')\n      decoded += decipher.final('utf8')\n\n      decoded = JSON.parse(decoded)\n    } catch (err) {\n      throw new Error('Illegal Buffer')\n    }\n\n    if (decoded.watermark.appid !== this.appId) {\n      throw new Error('Illegal Buffer')\n    }\n\n    return decoded\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/wechat-lib/mina.js","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 54\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 55\n// module chunks = 0","import * as qiniu from '../lib/qiniu'\nimport { controller, get } from '../lib/decorator'\n\n@controller('/api/qiniu')\nexport class QiniuController {\n  @get('/token')\n  async qiniuToken(ctx) {\n    let key = ctx.query.key\n    let token = qiniu.uptoken(key)\n\n    ctx.body = {\n      success: true,\n      data: {\n        key,\n        token\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/qiniu.js","import qiniu from 'qiniu'\nimport config from '../config'\nimport { exec } from 'shelljs'\n\n// qiniu.conf.ACCESS_KEY = config.qiniu.AK\n// qiniu.conf.SECRET_KEY = config.qiniu.SK\n\n// const bucket = config.qiniu.bucket\n\nconst mac = new qiniu.auth.digest.Mac(config.qiniu.AK, config.qiniu.SK)\nlet options = {\n  scope: config.qiniu.bucket\n}\n\nlet putPolicy = new qiniu.rs.PutPolicy(options)\n\nconst uploadToken = putPolicy.uploadToken(mac)\n\n// \"qiniu\": \"^7.1.3\" // 太新了，装6.1.13\n// 7.1.3 方式\n// let mac = new qiniu.auth.digest.Mac(accessKey, secretKey)\n// let config = new qiniu.conf.Config()\n// config.useHttpsDomain = true\n// config.zone = qiniu.zone.Zone.z2\n// let bucketManager = new qiniu.rs.BucketManager(mac, config)\n\nexport const uptoken = (key) => {\n  // return new qiniu.rs.PutPolicy(`${bucket}:${key}`).token()\n  return uploadToken\n}\n\nexport const fetchImage = async (url, key) => {\n  // const client = new qiniu.rs.Client()\n\n  return new Promise((resolve, reject) => {\n    // client.fetch(url, bucket, key, (err, ret) => {\n    //   if (err) reject(err)\n    //   else resolve(ret)\n    // })\n\n    const bash = `qshell fetch ${url} ${config.qiniu.bucket} ${key}`\n    const child = exec(bash, { async: true })\n    child.stdout.on('data', data => {\n      resolve(data)\n    })\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/lib/qiniu.js","module.exports = require(\"qiniu\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"qiniu\"\n// module id = 58\n// module chunks = 0","module.exports = require(\"shelljs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shelljs\"\n// module id = 59\n// module chunks = 0","var map = {\n\t\"./article.js\": 11,\n\t\"./mina.js\": 12\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 60;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/routes/public \\.js$\n// module id = 60\n// module chunks = 0","const restfulRouter = require('./restful')\n\nexport const addRestful = app => {\n  app.use(restfulRouter.routes()).use(restfulRouter.allowedMethods())\n}\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/rest.js","const Router = require('koa-router')\nconst rest = require('./controller')\n\nconst router = new Router({ prefix: '/autoapi' })\n\nfunction skipMid(ctx, next, str) {\n  //是否设置跳过\n  if (!router.skip || !router.skip[ctx.params.tab]) {\n    return false\n  }\n  //是否全部跳过\n  if (router.skip[ctx.params.tab] == 'ALL') {\n    next()\n    return true\n  }\n  //是否跳过一个\n  if (router.skip[ctx.params.tab].split(',').indexOf(str) >= 0) {\n    next()\n    return true\n  }\n  return false\n}\n\nrouter\n  .get('/:tab', rest.get)\n  .post('/:tab', rest.post)\n\n// router.get('/:tab', (ctx, next) => {\n//   if (skipMid(ctx, next, 'GET')) {\n//     return\n//   }\n//   console.log('进来了', skipMid(ctx, next, 'GET'))\n//   rest.get(ctx, next)\n// })\n\n// router.use('/:tab').get(function(ctx, next) {\n//   if (skipMid(ctx, next, 'GET')) {\n//     return\n//   }\n//   rest.get(ctx, next)\n// })\n\n// rest.skip = {\n//   'user': 'fetchID'  // 跳过对user资源的fetchID请求\n// }\n\nmodule.exports = router\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/restful/index.js","const mongoose = require('mongoose')\nconst Schema = mongoose.Schema\n\nconst getModel = function (tab) {\n  let model\n  try {\n    model = mongoose.model(tab)\n  } catch (error) {\n    model = mongoose.model(tab, new Schema({}, { strict: false }))\n  }\n  return model\n}\n\nexport const get = async (ctx, next) => {\n  let where = ctx.query._where\n  const sort = ctx.query._sort || {}\n  const skip = parseInt(ctx.query._skip, 10) || 0\n  const limit = parseInt(ctx.query._limit, 10) || 100\n  const populate = ctx.query._populate || ''\n  if (where) {\n    where = JSON.parse(where)\n    for (var key in where) {\n      if (where[key]._regex) {\n        where[key] = new RegExp(where[key]._regex)\n      }\n      if (where[key]._lt) {\n        where[key].$lt = where[key]._lt\n        delete where[key]._lt\n      }\n      if (where[key]._lte) {\n        where[key].$lte = where[key]._lte\n        delete where[key]._lte\n      }\n      if (where[key]._gt) {\n        where[key].$gt = where[key]._gt\n        delete where[key]._gt\n      }\n      if (where[key]._gte) {\n        where[key].$gte = where[key]._gte\n        delete where[key]._gte\n      }\n      if (where[key]._ne) {\n        where[key].$ne = where[key]._ne\n        delete where[key]._ne\n      }\n    }\n  }\n  console.log(populate)\n  //查询 - 根据：tab\n  const data = await getModel(ctx.params.tab)\n    .find(where)\n    .sort(sort)\n    .skip(skip)\n    .limit(limit)\n    .populate(populate)\n    .exec()\n\n  ctx.body = ({\n    success: 'true',\n    data\n  })\n}\n\nexport const post = async function (ctx, next) {\n  const Model = getModel(req.params.tab)\n  const doc = ctx.request.body\n  const entity = new Model(doc)\n  const data = await entity.save()\n  ctx.body = {\n    success: true,\n    data\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/restful/controller.js","const { Route } = require('../lib/decorator')\n// const { resolve } = require('path')\n// 只要执行此中间件，就等于执行了整个路由中间层\nexport const router = app => {\n  // const apiPath = resolve(__dirname, '../routes')\n  // Todo: 待修复，现在只能传相对路径，且字符串\n  const router = new Route(app, '../routes')\n\n  router.init()\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middleware/router.js","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'nuxt-temp',\n    meta: [\n      { charset: 'utf-8' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n      { rel: 'stylesheet', name: 'iview', href: '/styles/iview.css' },\n      { rel: 'stylesheet', name: 'theme', href: '' }\n    ]\n  },\n  css: [\n    { src: '~assets/css/main.css' },\n    'quill/dist/quill.snow.css',\n    'quill/dist/quill.bubble.css',\n    'quill/dist/quill.core.css'\n    // { src: 'iview/dist/styles/iview.css' }\n  ],\n  plugins: [\n    { src: '~plugins/flexible.js', ssr: false },\n    { src: '~plugins/iview.js', ssr: true },\n    { src: '~/plugins/quillEditor.js', ssr: false }\n  ],\n  loading: './components/loading.vue',\n  env: {\n    NODE_ENV: process.env.NODE_ENV || 'prodev'\n  },\n  cache: {\n    max: 1000,\n    maxAge: 900000\n  },\n  router: {\n    middleware: 'route' // 在每页渲染前运行 middleware/route.js 中间件的逻辑\n  },\n  build: {\n    // babel: {  // 前端不需要修饰器，后端才要\n    //   plugins: ['babel-plugin-transform-decorators-legacy']\n    // },\n    vendor: ['axios', 'iview', './plugins/iview.js'],\n    extend(config, ctx) {\n      // if (ctx.isClient) {\n      if (process.client) {\n        // config.module.rules.push({\n        //   enforce: 'pre',\n        //   test: /\\.(js|vue)$/,\n        //   loader: 'eslint-loader',\n        //   exclude: /(node_modules)/\n        // })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js"],"sourceRoot":""}